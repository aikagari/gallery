<html lang="ru">
<head>
    <link href="https://vjs.zencdn.net/7.6.5/video-js.css" rel="stylesheet">

    <!-- If you'd like to support IE8 (for Video.js versions prior to v7) -->
    <script src="https://vjs.zencdn.net/ie8/1.1.2/videojs-ie8.min.js"></script>
    <!-- Core CSS file -->
    <link rel="stylesheet" href="{{ url_for('static', filename='node_modules/photoswipe/dist/photoswipe.css') }}">

    <!-- Skin CSS file (styling of UI - buttons, caption, etc.)
         In the folder of skin CSS file there are also:
         - .png and .svg icons sprite,
         - preloader.gif (for browsers that do not support CSS animations) -->
    <link rel="stylesheet"
          href="{{ url_for('static', filename='node_modules/photoswipe/dist/default-skin/default-skin.css') }}">

    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    <!-- Core JS file -->
    <script src="{{ url_for('static', filename='node_modules/photoswipe/dist/photoswipe.js') }}"></script>
    <!-- UI JS file -->
    <script src="{{ url_for('static', filename='node_modules/photoswipe/dist/photoswipe-ui-default.js') }}"></script>
    <title>Content</title>
</head>


<body>

<button class="tablink" onclick="openPage('Picture', this)" id="defaultOpen">Picture</button>
<button class="tablink" onclick="openPage('Video', this)">Video</button>

<div id="Video" class="tabcontent">
    {% for video in file_list.video %}
        <video id='my-video' class='video-js' controls preload='auto' width='640' height='264' data-setup='{}'>
            <source src='http://192.168.1.4:5000/get_video/{{ video.name }}' type="video/{{ video.ext }}">
            <p class='vjs-no-js'>
                To view this video please enable JavaScript, and consider upgrading to a web browser that
                <a href='https://videojs.com/html5-video-support/' target='_blank'>supports HTML5 video</a>
            </p>
        </video>
    {% endfor %}

    <script src='https://vjs.zencdn.net/7.6.5/video.js'></script>
</div>


<div id="Picture" class="tabcontent">
{#    <button id="btn">Open PhotoSwipe</button>#}

    {% for picture in file_list.picture %}
        <img onclick="openPhotoSwipe(this);" id="test" src="http://192.168.1.4:5000/get_image/{{ picture.name }}" width="{{ picture.width / 4 }}" height="picture.height / 4">
    {% endfor %}

    <!-- Root element of PhotoSwipe. Must have class pswp. -->
    <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

        <!-- Background of PhotoSwipe.
             It's a separate element, as animating opacity is faster than rgba(). -->
        <div class="pswp__bg"></div>

        <!-- Slides wrapper with overflow:hidden. -->
        <div class="pswp__scroll-wrap">

            <!-- Container that holds slides. PhotoSwipe keeps only 3 slides in DOM to save memory. -->
            <div class="pswp__container">
                <!-- don't modify these 3 pswp__item elements, data is added later on -->
                <div class="pswp__item"></div>
                <div class="pswp__item"></div>
                <div class="pswp__item"></div>
            </div>

            <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
            <div class="pswp__ui pswp__ui--hidden">

                <div class="pswp__top-bar">

                    <!--  Controls are self-explanatory. Order can be changed. -->

                    <div class="pswp__counter"></div>

                    <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                    <!-- element will get class pswp__preloader--active when preloader is running -->
                    <div class="pswp__preloader">
                        <div class="pswp__preloader__icn">
                            <div class="pswp__preloader__cut">
                                <div class="pswp__preloader__donut"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                    <div class="pswp__share-tooltip"></div>
                </div>

                <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
                </button>

                <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
                </button>

                <div class="pswp__caption">
                    <div class="pswp__caption__center"></div>
                </div>

            </div>

        </div>

    </div>

    <script>
        var openPhotoSwipe = function (elem) {
            console.log(elem.id);
            var pswpElement = document.querySelectorAll('.pswp')[0];

            // build items array
            var items = [
                {% for picture in file_list.picture %}
                    {
                        src: 'http://192.168.1.4:5000/get_image/{{ picture.name }}',
                        w: {{ picture.width }},
                        h: {{ picture.height }}
                    },
                {% endfor %}
            ];

            // define options (if needed)
            var options = {
                // history & focus options are disabled on CodePen
                history: false,
                focus: false,

                showAnimationDuration: 0,
                hideAnimationDuration: 0

            };

            var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, options);
            gallery.init();
        };

        {#openPhotoSwipe();#}

        {#document.getElementsByClassName('img_src').onclick = openPhotoSwipe;#}
    </script>
</div>
</body>
</html>